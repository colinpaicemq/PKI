//IBMRACF2 JOB 1,MSGCLASS=H,RESTART=DEL
//  EXPORT SYMLIST=*
//LIST EXEC PGM=IKJEFT01,REGION=0M
//SYSPRINT DD SYSOUT=*
//SYSTSPRT DD SYSOUT=*
//SYSTSIN DD *,SYMBOLS=JCLONLY
RACDCERT LIST CERTAUTH
/*
//DEL EXEC PGM=IKJEFT01,REGION=0M
//  SET SSLCERT='SSLCERT'
//  SET LOCALCA='LOCAL2PKI CA'
//  SET LOCALRA='LOCA2 PKI RA'
//  SET ORG='YOUR2COMPANY'
//  SET OU='SSS'
//  SET CARING='CARING'
//  SET WEBRING='WEBRING'
//  SET WEBSRV='WEBSRV2'
//  SET PKISRVD='PKISRVD'
//SYSPRINT DD SYSOUT=*
//SYSTSPRT DD SYSOUT=*
//SYSTSIN DD *,SYMBOLS=JCLONLY
RACDCERT LIST    (LABEL('&LOCALCA'))      CERTAUTH
RACDCERT DELETE  (LABEL('&LOCALCA'))      CERTAUTH

RACDCERT LIST    (LABEL('&LOCALRA'))      ID(&PKISRVD)
RACDCERT DELETE  (LABEL('&LOCALRA'))      ID(&PKISRVD)

RACDCERT LISTRING(&CARING) ID(&PKISRVD)
RACDCERT DELRING(&CARING) ID(&PKISRVD)

RACDCERT ADDRING(&WEBRING) ID(&WEBSRV)
RACDCERT LISTRING(&WEBRING) ID(&WEBSRV)
RACDCERT DELRING(&WEBRING) ID(&WEBSRV)

RLIST   RDATALIB &PKISRVD..&CARING..LST ALL
RDELETE RDATALIB &PKISRVD..&CARING..LST

RLIST   RDATALIB &WEBSRV.&WEBRING..LST ALL
RDELETE RDATALIB &WEBSRV.&WEBRING..LST

RACDCERT LIST    (LABEL('&SSLCERT')) ID(&WEBSRV)
RACDCERT DELETE  (LABEL('&SSLCERT')) ID(&WEBSRV)
//DEF EXEC PGM=IKJEFT01,REGION=0M
//SYSPRINT DD SYSOUT=*
//SYSTSPRT DD SYSOUT=*
//SYSTSIN DD *,SYMBOLS=JCLONLY
RACDCERT GENCERT CERTAUTH -
   SUBJECTSDN(CN('PKICA') -
              OU('&OU') -
              O('&ORG')          -
             ) -
   WITHLABEL('&LOCALCA') -
   NOTAFTER(DATE(2041/11/07)) -
   SIZE(2048)  -
   ALTNAME(DOMAIN('WWW.YOURCOMPANY') IP(10.1.1.2))

RACDCERT CERTAUTH EXPORT(LABEL('&LOCALCA')) -
   DSN('&PKISRVD..PKICAKEY.BACKUP.P12BIN') FORMAT(PKCS12DER) -
    PASSWORD('PASSW0RD')

RACDCERT CERTAUTH ALTER(LABEL('&LOCALCA')) HIGHTRUST

RACDCERT CERTAUTH EXPORT(LABEL('&LOCALCA')) -
  DSN('&PKISRVD..CACERT.DERBIN') FORMAT(CERTDER)

RACDCERT ID(&PKISRVD) GENCERT -
    SUBJECTSDN(CN('REGISTRATION_AUTHORITY')-
               OU('&OU') -
               O('&ORG') -
              )  -
    KEYUSAGE(HANDSHAKE)  -
    SIGNWITH(CERTAUTH LABEL('&LOCALCA')) -
    NOTAFTER(DATE(2041/11/07))  -
    WITHLABEL('&LOCALRA')

RACDCERT ID(&PKISRVD) EXPORT(LABEL('&LOCALRA')) -
  DSN('&PKISRVD..RAKEY.BACKUP.P12BIN') FORMAT(PKCS12DER) -
  PASSWORD('PASSW0RD')

RACDCERT ADDRING(&CARING) ID(&PKISRVD)
RDEFINE FACILITY PIDSRVD.&CARING..LST

RACDCERT ID(&PKISRVD) -
     CONNECT(CERTAUTH  LABEL('&LOCALCA') -
         RING(&CARING) -
      USAGE(PERSONAL) DEFAULT)
RACDCERT ID(&PKISRVD) -
    CONNECT(LABEL('&LOCALRA') -
            RING(&CARING) USAGE(PERSONAL))

RACDCERT GENCERT ID(&WEBSRV) -
    SUBJECTSDN(CN('&WEBSRV'        ) -
               OU('&OU')           -
               O('&ORG')-
              ) -
    WITHLABEL('&SSLCERT')  -
    SIGNWITH(CERTAUTH   LABEL('&LOCALCA')) -
    NOTAFTER(DATE(2026/11/07)) -
    ALTNAME(DOMAIN('WWW.YOURCOMPANY')IP(10.1.1.2))

RACDCERT ADDRING(&WEBRING) ID(&WEBSRV)
RDEFINE RDATALIB &WEBSRV.&WEBRING..LST

 RACDCERT  ID(&WEBSRV) CONNECT(ID(&WEBSRV) -
     LABEL('&SSLCERT') RING(&WEBRING) -
     USAGE(PERSONAL) DEFAULT)

 RACDCERT  ID(&WEBSRV) -
     CONNECT(CERTAUTH  LABEL('&LOCALCA') RING(&WEBRING))

RACDCERT CERTAUTH EXPORT(LABEL('&LOCALCA')) -
  DSN('&PKISRVD..WEBROOT.DERBIN') FORMAT(CERTDER)

 PERMIT IRR.DIGTCERT.LISTRING CLASS(FACILITY) -
    ID(&WEBSRV) ACCESS(READ)

RACDCERT LISTRING(&CARING) ID(&PKISRVD)
